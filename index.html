<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ëª¬í‹°í™€ ë”œë ˆë§ˆ AI ì—ì´ì „íŠ¸ ì‹œë®¬ë ˆì´ì…˜</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        .game-area {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        .game-panel {
            background: rgba(255, 255, 255, 0.15);
            padding: 25px;
            border-radius: 15px;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        .doors {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
        }
        .door {
            width: 80px;
            height: 100px;
            background: #8B4513;
            border: 3px solid #654321;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        .door.selected {
            background: #FFD700;
            border-color: #FFA500;
            transform: scale(1.1);
        }
        .door.opened {
            background: #FF6B6B;
            border-color: #FF4757;
        }
        .door.winner {
            background: #4ECDC4;
            border-color: #45B7AB;
        }
        .probability-display {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-family: monospace;
        }
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        button {
            background: linear-gradient(45deg, #FF6B6B, #4ECDC4);
            border: none;
            color: white;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        .chart-container {
            position: relative;
            height: 300px;
            margin: 20px 0;
        }
        .log {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 10px;
            height: 200px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
        .agent-info {
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
        }
        .probability-bar {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            height: 20px;
            margin: 10px 0;
            overflow: hidden;
        }
        .probability-fill {
            height: 100%;
            background: linear-gradient(90deg, #FF6B6B, #4ECDC4);
            border-radius: 10px;
            transition: width 0.5s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§  ëª¬í‹°í™€ ë”œë ˆë§ˆ AI ì—ì´ì „íŠ¸ ì‹œë®¬ë ˆì´ì…˜</h1>
        
        <div class="game-area">
            <div class="game-panel">
                <h3>ğŸ¯ ê²Œì„ ì§„í–‰</h3>
                <div class="doors">
                    <div class="door" data-door="0">ğŸšª</div>
                    <div class="door" data-door="1">ğŸšª</div>
                    <div class="door" data-door="2">ğŸšª</div>
                </div>
                
                <div class="agent-info">
                    <h4>í˜„ì¬ AI ì—ì´ì „íŠ¸: <span id="current-agent">ì „ëµ ì„ íƒ</span></h4>
                    <div class="probability-display">
                        <div>ë¬¸ 1 í™•ë¥ : <span id="prob-0">33.33%</span></div>
                        <div class="probability-bar"><div class="probability-fill" id="bar-0"></div></div>
                        <div>ë¬¸ 2 í™•ë¥ : <span id="prob-1">33.33%</span></div>
                        <div class="probability-bar"><div class="probability-fill" id="bar-1"></div></div>
                        <div>ë¬¸ 3 í™•ë¥ : <span id="prob-2">33.33%</span></div>
                        <div class="probability-bar"><div class="probability-fill" id="bar-2"></div></div>
                    </div>
                </div>
                
                <div class="controls">
                    <button onclick="startGame('stay')">ìœ ì§€ ì „ëµ AI</button>
                    <button onclick="startGame('switch')">ë³€ê²½ ì „ëµ AI</button>
                    <button onclick="startGame('bayesian')">ë² ì´ì¦ˆ AI</button>
                    <button onclick="startGame('human_intuition')">ì¸ê°„ ì§ê´€ AI</button>
                    <button onclick="runSimulation()">ëŒ€ëŸ‰ ì‹œë®¬ë ˆì´ì…˜</button>
                    <button onclick="resetAll()" style="background: linear-gradient(45deg, #FF4757, #FF3838);">ğŸ”„ ì „ì²´ ì´ˆê¸°í™”</button>
                </div>
                
                <div class="log" id="game-log"></div>
            </div>
            
            <div class="game-panel">
                <h3>ğŸ“Š ì‹¤ì‹œê°„ í†µê³„</h3>
                <div class="chart-container">
                    <canvas id="winRateChart"></canvas>
                </div>
                <div class="stat-card">
                    <h4>ğŸ† ìŠ¹ë¥  ë¹„êµ</h4>
                    <div>ìœ ì§€ ì „ëµ: <span id="stay-rate">0%</span></div>
                    <div>ë³€ê²½ ì „ëµ: <span id="switch-rate">0%</span></div>
                    <div>ë² ì´ì¦ˆ ì „ëµ: <span id="bayesian-rate">0%</span></div>
                    <div>ì¸ê°„ ì§ê´€: <span id="human-rate">0%</span></div>
                </div>
            </div>
        </div>
        
        <div class="stats">
            <div class="stat-card">
                <h4>ğŸ” AI ì˜ì‚¬ê²°ì • ë¶„ì„</h4>
                <div id="decision-analysis">
                    <p>AI ì—ì´ì „íŠ¸ì˜ í™•ë¥ ì  ì˜ì‚¬ê²°ì • ê³¼ì •ì„ ê´€ì°°í•´ë³´ì„¸ìš”.</p>
                    <p>ë² ì´ì¦ˆ ì •ë¦¬ë¥¼ í™œìš©í•œ í™•ë¥  ì—…ë°ì´íŠ¸ì™€ ìµœì  ì „ëµ ì„ íƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                </div>
            </div>
            
            <div class="stat-card">
                <h4>ğŸ“ˆ ê²Œì„ í†µê³„</h4>
                <div>ì´ ê²Œì„ ìˆ˜: <span id="total-games">0</span></div>
                <div>ìœ ì§€ ì „ëµ ìŠ¹ìˆ˜: <span id="stay-wins">0</span></div>
                <div>ë³€ê²½ ì „ëµ ìŠ¹ìˆ˜: <span id="switch-wins">0</span></div>
                <div>ë² ì´ì¦ˆ ì „ëµ ìŠ¹ìˆ˜: <span id="bayesian-wins">0</span></div>
                <div>ì¸ê°„ ì§ê´€ ìŠ¹ìˆ˜: <span id="human-wins">0</span></div>
            </div>
        </div>
        
        <div class="stats">
            <div class="stat-card">
                <h4>ğŸ¤– ìœ ì§€ ì „ëµ AI</h4>
                <div style="font-size: 14px; line-height: 1.6;">
                    <p><strong>ğŸ¯ ì „ëµ:</strong> ìµœì´ˆ ì„ íƒì„ ì ˆëŒ€ ë°”ê¾¸ì§€ ì•ŠìŒ</p>
                    <p><strong>ğŸ§  ì‚¬ê³ ë°©ì‹:</strong> "ì²« ë²ˆì§¸ ì§ê°ì´ ë§ë‹¤"</p>
                    <p><strong>ğŸ“Š ì´ë¡ ì  ìŠ¹ë¥ :</strong> 33.33%</p>
                    <p><strong>âš–ï¸ ì¥ì :</strong> ë‹¨ìˆœí•˜ê³  ì¼ê´€ì„± ìˆìŒ</p>
                    <p><strong>âš ï¸ ë‹¨ì :</strong> ìƒˆë¡œìš´ ì •ë³´ë¥¼ ë¬´ì‹œí•¨</p>
                </div>
            </div>
            
            <div class="stat-card">
                <h4>ğŸ”„ ë³€ê²½ ì „ëµ AI</h4>
                <div style="font-size: 14px; line-height: 1.6;">
                    <p><strong>ğŸ¯ ì „ëµ:</strong> í•­ìƒ ì„ íƒì„ ë°”ê¿ˆ</p>
                    <p><strong>ğŸ§  ì‚¬ê³ ë°©ì‹:</strong> "ì‚¬íšŒìê°€ ë„ì›€ì„ ì£¼ê³  ìˆë‹¤"</p>
                    <p><strong>ğŸ“Š ì´ë¡ ì  ìŠ¹ë¥ :</strong> 66.67%</p>
                    <p><strong>âš–ï¸ ì¥ì :</strong> í†µê³„ì ìœ¼ë¡œ ìµœì </p>
                    <p><strong>âš ï¸ ë‹¨ì :</strong> ì§ê´€ì— ë°˜í•˜ëŠ” ì„ íƒ</p>
                </div>
            </div>
            
            <div class="stat-card">
                <h4>ğŸ§® ë² ì´ì¦ˆ í™•ë¥  AI</h4>
                <div style="font-size: 14px; line-height: 1.6;">
                    <p><strong>ğŸ¯ ì „ëµ:</strong> ë² ì´ì¦ˆ ì •ë¦¬ë¡œ í™•ë¥  ê³„ì‚° í›„ ìµœì  ì„ íƒ</p>
                    <p><strong>ğŸ§  ì‚¬ê³ ë°©ì‹:</strong> "ìˆ˜í•™ì  í™•ë¥ ì´ ì§„ì‹¤ì„ ë§í•œë‹¤"</p>
                    <p><strong>ğŸ“Š ì´ë¡ ì  ìŠ¹ë¥ :</strong> 66.67% (ë³€ê²½ ì „ëµê³¼ ë™ì¼)</p>
                    <p><strong>âš–ï¸ ì¥ì :</strong> íˆ¬ëª…í•œ ì˜ì‚¬ê²°ì • ê³¼ì •</p>
                    <p><strong>ğŸ”¬ íŠ¹ì§•:</strong> ì‹¤ì‹œê°„ í™•ë¥  ì—…ë°ì´íŠ¸</p>
                </div>
            </div>
        </div>
        
        <div class="stats">
            <div class="stat-card">
                <h4>ğŸ‘¤ ì¸ê°„ ì§ê´€ AI</h4>
                <div style="font-size: 14px; line-height: 1.6;">
                    <p><strong>ğŸ¯ ì „ëµ:</strong> ì‹¬ë¦¬ì  í¸í–¥ ê¸°ë°˜ ê²°ì •</p>
                    <p><strong>ğŸ§  íŠ¹ì§•:</strong> 
                        <ul>
                            <li>ë‹» ë‚´ë¦¼ íš¨ê³¼ (ì´ˆê¸° ì„ íƒ ì„ í˜¸)</li>
                            <li>ê°€ìš©ì„± í¸í–¥ (ì‰½ê²Œ ë– ì˜¤ë¥´ëŠ” ì •ë³´ ì¤‘ì‹œ)</li>
                            <li>í™•ì¦ í¸í–¥ (ìì‹ ì˜ ì„ íƒ ì •ë‹¹í™”)</li>
                        </ul>
                    </p>
                    <p><strong>ìŠ¹ìˆ˜:</strong> <span id="human-wins">0</span></p>
                    <p><strong>ìŠ¹ë¥ :</strong> <span id="human-rate">0%</span></p>
                </div>
            </div>
        </div>
        
        <div class="stats">
            <div class="stat-card">
                <h4>ğŸ“ ëª¬í‹°í™€ ë”œë ˆë§ˆ ì´ë¡ </h4>
                <div style="font-size: 14px; line-height: 1.6;">
                    <p><strong>ğŸª ìƒí™©:</strong> 3ê°œ ë¬¸, 1ê°œ ìƒí’ˆ, 2ê°œ ì—¼ì†Œ</p>
                    <p><strong>ğŸ¯ í•µì‹¬:</strong> ì‚¬íšŒìê°€ ì—¼ì†Œ ë¬¸ì„ ì—´ì–´ì¤Œìœ¼ë¡œì¨ ì •ë³´ë¥¼ ì œê³µ</p>
                    <p><strong>ğŸ§® ìˆ˜í•™ì  ì„¤ëª…:</strong></p>
                    <ul style="margin: 10px 0; padding-left: 20px;">
                        <li>ìµœì´ˆ ì„ íƒ í™•ë¥ : 1/3</li>
                        <li>ë‚˜ë¨¸ì§€ ë‘ ë¬¸ í™•ë¥ : 2/3</li>
                        <li>ì‚¬íšŒìê°€ 1ê°œ ë¬¸ì„ ì—´ë©´ â†’ ë‚¨ì€ 1ê°œ ë¬¸ì´ 2/3 í™•ë¥ ì„ ê°€ì§</li>
                    </ul>
                    <p><strong>ğŸ’¡ ì§ê´€ì  ì´í•´:</strong> ì‚¬íšŒìëŠ” í•­ìƒ ì—¼ì†Œê°€ ìˆëŠ” ë¬¸ì„ ì—´ì–´ì£¼ë¯€ë¡œ, ë°”ê¾¸ëŠ” ê²ƒì´ ìœ ë¦¬!</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ê²Œì„ ìƒíƒœ ê´€ë¦¬
        let gameState = {
            prizeDoor: null,
            selectedDoor: null,
            openedDoor: null,
            currentAgent: null,
            gamePhase: 'setup', // setup, selected, opened, finished
            probabilities: [1/3, 1/3, 1/3]
        };

        // í†µê³„ ë°ì´í„°
        let statistics = {
            stay: { games: 0, wins: 0 },
            switch: { games: 0, wins: 0 },
            bayesian: { games: 0, wins: 0 },
            human_intuition: { games: 0, wins: 0 }
        };

        // ì°¨íŠ¸ ì´ˆê¸°í™”
        const ctx = document.getElementById('winRateChart').getContext('2d');
        const chart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: [],
                datasets: [{
                    label: 'ìœ ì§€ ì „ëµ',
                    data: [],
                    borderColor: '#FF6B6B',
                    backgroundColor: 'rgba(255, 107, 107, 0.1)',
                    tension: 0.4
                }, {
                    label: 'ë³€ê²½ ì „ëµ',
                    data: [],
                    borderColor: '#4ECDC4',
                    backgroundColor: 'rgba(78, 205, 196, 0.1)',
                    tension: 0.4
                }, {
                    label: 'ë² ì´ì¦ˆ ì „ëµ',
                    data: [],
                    borderColor: '#45B7AB',
                    backgroundColor: 'rgba(69, 183, 171, 0.1)',
                    tension: 0.4
                }, {
                    label: 'ì¸ê°„ ì§ê´€',
                    data: [],
                    borderColor: '#9B59B6',
                    backgroundColor: 'rgba(155, 89, 182, 0.1)',
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'ê²Œì„ ì§„í–‰ì— ë”°ë¥¸ ìŠ¹ë¥  ë³€í™”',
                        color: 'white'
                    },
                    legend: {
                        labels: {
                            color: 'white'
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 100,
                        ticks: {
                            color: 'white'
                        },
                        grid: {
                            color: 'rgba(255, 255, 255, 0.1)'
                        }
                    },
                    x: {
                        ticks: {
                            color: 'white'
                        },
                        grid: {
                            color: 'rgba(255, 255, 255, 0.1)'
                        }
                    }
                }
            }
        });

        // AI ì—ì´ì „íŠ¸ í´ë˜ìŠ¤
        class MontyHallAgent {
            constructor(strategy) {
                this.strategy = strategy;
                this.name = this.getStrategyName(strategy);
            }

            getStrategyName(strategy) {
                switch(strategy) {
                    case 'stay': return 'ìœ ì§€ ì „ëµ AI';
                    case 'switch': return 'ë³€ê²½ ì „ëµ AI';
                    case 'bayesian': return 'ë² ì´ì¦ˆ í™•ë¥  AI';
                    case 'human_intuition': return 'ì¸ê°„ ì§ê´€ ì‹œë®¬ë ˆì´ì…˜';
                    default: return 'Unknown AI';
                }
            }

            // ë² ì´ì¦ˆ ì •ë¦¬ë¥¼ í™œìš©í•œ í™•ë¥  ê³„ì‚°
            calculateBayesianProbabilities(selectedDoor, openedDoor) {
                let probabilities = [1/3, 1/3, 1/3];
                
                // ì‚¬íšŒìê°€ ë¬¸ì„ ì—° í›„ í™•ë¥  ì—…ë°ì´íŠ¸
                probabilities[openedDoor] = 0;
                
                // ë² ì´ì¦ˆ ì •ë¦¬ ì ìš©
                if (this.strategy === 'bayesian') {
                    // ì„ íƒí•˜ì§€ ì•Šì€ ë¬¸ë“¤ì˜ í™•ë¥ ì„ ì¬ë¶„ë°°
                    let remainingProb = 2/3;
                    for (let i = 0; i < 3; i++) {
                        if (i !== selectedDoor && i !== openedDoor) {
                            probabilities[i] = remainingProb;
                        }
                    }
                    probabilities[selectedDoor] = 1/3;
                }
                
                return probabilities;
            }

            // ì˜ì‚¬ê²°ì • ë¡œì§
            makeDecision(selectedDoor, openedDoor) {
                let decision = {
                    finalChoice: selectedDoor,
                    reasoning: "",
                    probabilities: this.calculateBayesianProbabilities(selectedDoor, openedDoor)
                };

                switch(this.strategy) {
                    case 'stay':
                        decision.reasoning = `ìœ ì§€ ì „ëµ: ìµœì´ˆ ì„ íƒ ë¬¸ ${selectedDoor + 1}ì„ ê·¸ëŒ€ë¡œ ìœ ì§€í•©ë‹ˆë‹¤.`;
                        break;
                    
                    case 'switch':
                        // ì„ íƒí•˜ì§€ ì•Šì€ ì—´ë¦¬ì§€ ì•Šì€ ë¬¸ ì°¾ê¸°
                        for (let i = 0; i < 3; i++) {
                            if (i !== selectedDoor && i !== openedDoor) {
                                decision.finalChoice = i;
                                break;
                            }
                        }
                        decision.reasoning = `ë³€ê²½ ì „ëµ: ë¬¸ ${selectedDoor + 1}ì—ì„œ ë¬¸ ${decision.finalChoice + 1}ë¡œ ë³€ê²½í•©ë‹ˆë‹¤.`;
                        break;
                    
                    case 'bayesian':
                        // ë² ì´ì¦ˆ í™•ë¥ ì„ ê¸°ë°˜ìœ¼ë¡œ ìµœì  ì„ íƒ
                        let maxProb = Math.max(...decision.probabilities);
                        decision.finalChoice = decision.probabilities.indexOf(maxProb);
                        decision.reasoning = `ë² ì´ì¦ˆ ì „ëµ: í™•ë¥  ê³„ì‚° ê²°ê³¼ ë¬¸ ${decision.finalChoice + 1} (í™•ë¥ : ${(maxProb * 100).toFixed(1)}%)ì„ ì„ íƒí•©ë‹ˆë‹¤.`;
                        break;
                }

                return decision;
            }
        }

        // ì¸ê°„ ì§ê´€ ì—ì´ì „íŠ¸ í´ë˜ìŠ¤
        class HumanIntuitionAgent extends MontyHallAgent {
            constructor() {
                super('human_intuition');
                this.name = 'ì¸ê°„ ì§ê´€ ì‹œë®¬ë ˆì´ì…˜';
                this.biases = {
                    anchoring: 0.7,        // ì´ˆê¸° ì„ íƒì— ê³ ì°©í•˜ëŠ” ê²½í–¥
                    availability: 0.6,     // ì‰½ê²Œ ë– ì˜¤ë¥´ëŠ” ì •ë³´ì— ì˜ì¡´
                    confirmation: 0.65     // ìì‹ ì˜ ì„ íƒì„ ì •ë‹¹í™”í•˜ë ¤ëŠ” ê²½í–¥
                };
            }

            makeDecision(selectedDoor, openedDoor) {
                let decision = {
                    finalChoice: selectedDoor,
                    reasoning: "",
                    probabilities: this.calculateHumanProbabilities(selectedDoor, openedDoor)
                };

                // ì¸ê°„ì˜ ì‹¬ë¦¬ì  ìš”ì¸ì„ ê³ ë ¤í•œ ì˜ì‚¬ê²°ì •
                const random = Math.random();
                
                if (random < this.biases.anchoring) {
                    // ì´ˆê¸° ì„ íƒ ìœ ì§€ (ë‹» ë‚´ë¦¼ íš¨ê³¼)
                    decision.reasoning = "ì²˜ìŒ ì„ íƒì´ ë§ì„ ê²ƒ ê°™ì€ ì§ê°ì´ ë“­ë‹ˆë‹¤.";
                    decision.finalChoice = selectedDoor;
                } else if (random < (this.biases.anchoring + this.biases.availability)) {
                    // ìƒˆë¡œìš´ ì •ë³´ì— ì˜í–¥ë°›ì•„ ë³€ê²½
                    decision.reasoning = "ë‹¤ë¥¸ ì„ íƒì§€ê°€ ë” ì¢‹ì•„ ë³´ì…ë‹ˆë‹¤.";
                    for (let i = 0; i < 3; i++) {
                        if (i !== selectedDoor && i !== openedDoor) {
                            decision.finalChoice = i;
                            break;
                        }
                    }
                } else {
                    // ì§ê´€ì  íŒë‹¨
                    decision.reasoning = "ê·¸ëƒ¥ ì´ ë¬¸ì´ ì¢‹ì€ ëŠë‚Œì…ë‹ˆë‹¤.";
                    const availableDoors = [0, 1, 2].filter(d => d !== openedDoor);
                    decision.finalChoice = availableDoors[Math.floor(Math.random() * availableDoors.length)];
                }

                return decision;
            }

            calculateHumanProbabilities(selectedDoor, openedDoor) {
                // ì¸ê°„ì˜ ì£¼ê´€ì  í™•ë¥  ê³„ì‚°
                let probabilities = [0.33, 0.33, 0.33];
                
                // ë‹» ë‚´ë¦¼ íš¨ê³¼: ì´ˆê¸° ì„ íƒì— ë” ë†’ì€ í™•ë¥  ë¶€ì—¬
                probabilities[selectedDoor] += 0.1;
                
                // ì—´ë¦° ë¬¸ì€ 0 í™•ë¥ 
                probabilities[openedDoor] = 0;
                
                // ë‚¨ì€ ë¬¸ì— ë‚˜ë¨¸ì§€ í™•ë¥  ë¶„ë°°
                const remaining = 1 - probabilities[selectedDoor];
                for (let i = 0; i < 3; i++) {
                    if (i !== selectedDoor && i !== openedDoor) {
                        probabilities[i] = remaining;
                    }
                }
                
                return probabilities;
            }
        }

        // ê²Œì„ ì‹œì‘
        function startGame(strategy) {
            resetGame();
            gameState.currentAgent = strategy === 'human_intuition' 
                ? new HumanIntuitionAgent()
                : new MontyHallAgent(strategy);
            gameState.prizeDoor = Math.floor(Math.random() * 3);
            gameState.gamePhase = 'setup';
            
            document.getElementById('current-agent').textContent = gameState.currentAgent.name;
            log(`ğŸ® ${gameState.currentAgent.name} ê²Œì„ ì‹œì‘`);
            log(`ğŸ ìƒí’ˆì´ ë¬¸ ${gameState.prizeDoor + 1} ë’¤ì— ìˆ¨ê²¨ì¡ŒìŠµë‹ˆë‹¤.`);
            
            // AIê°€ ë¬¸ ì„ íƒ
            setTimeout(() => {
                aiSelectDoor();
            }, 1000);
        }

        // AIê°€ ë¬¸ì„ ì„ íƒ
        function aiSelectDoor() {
            gameState.selectedDoor = Math.floor(Math.random() * 3);
            gameState.gamePhase = 'selected';
            
            updateDoorDisplay();
            log(`ğŸ¤– AIê°€ ë¬¸ ${gameState.selectedDoor + 1}ì„ ì„ íƒí–ˆìŠµë‹ˆë‹¤.`);
            
            // ì‚¬íšŒìê°€ ë¬¸ì„ ì—´ê¸°
            setTimeout(() => {
                hostOpenDoor();
            }, 1500);
        }

        // ì‚¬íšŒìê°€ ë¬¸ì„ ì—´ê¸°
        function hostOpenDoor() {
            // ìƒí’ˆì´ ì—†ê³  AIê°€ ì„ íƒí•˜ì§€ ì•Šì€ ë¬¸ì„ ì—´ê¸°
            let availableDoors = [];
            for (let i = 0; i < 3; i++) {
                if (i !== gameState.selectedDoor && i !== gameState.prizeDoor) {
                    availableDoors.push(i);
                }
            }
            
            gameState.openedDoor = availableDoors[Math.floor(Math.random() * availableDoors.length)];
            gameState.gamePhase = 'opened';
            
            // ë² ì´ì¦ˆ í™•ë¥  ê³„ì‚°
            gameState.probabilities = gameState.currentAgent.calculateBayesianProbabilities(
                gameState.selectedDoor, 
                gameState.openedDoor
            );
            
            updateDoorDisplay();
            updateProbabilityDisplay();
            log(`ğŸ­ ì‚¬íšŒìê°€ ë¬¸ ${gameState.openedDoor + 1}ì„ ì—´ì—ˆìŠµë‹ˆë‹¤. (ì—¼ì†Œê°€ ë‚˜ì™”ìŠµë‹ˆë‹¤!)`);
            log(`ğŸ§® í™•ë¥  ì¬ê³„ì‚°: ë¬¸1(${(gameState.probabilities[0] * 100).toFixed(1)}%), ë¬¸2(${(gameState.probabilities[1] * 100).toFixed(1)}%), ë¬¸3(${(gameState.probabilities[2] * 100).toFixed(1)}%)`);
            
            // AIê°€ ìµœì¢… ê²°ì •
            setTimeout(() => {
                aiFinalDecision();
            }, 2000);
        }

        // AI ìµœì¢… ê²°ì •
        function aiFinalDecision() {
            let decision = gameState.currentAgent.makeDecision(
                gameState.selectedDoor, 
                gameState.openedDoor
            );
            
            gameState.selectedDoor = decision.finalChoice;
            gameState.gamePhase = 'finished';
            
            // ê²°ê³¼ í™•ì¸
            let won = gameState.selectedDoor === gameState.prizeDoor;
            
            // í†µê³„ ì—…ë°ì´íŠ¸
            statistics[gameState.currentAgent.strategy].games++;
            if (won) {
                statistics[gameState.currentAgent.strategy].wins++;
            }
            
            updateDoorDisplay();
            updateStatistics();
            
            log(`ğŸ¯ ${decision.reasoning}`);
            log(`ğŸ† ê²°ê³¼: ${won ? 'ìŠ¹ë¦¬!' : 'íŒ¨ë°°!'} (ìƒí’ˆì€ ë¬¸ ${gameState.prizeDoor + 1} ë’¤ì— ìˆì—ˆìŠµë‹ˆë‹¤.)`);
            
            // ì˜ì‚¬ê²°ì • ë¶„ì„ ì—…ë°ì´íŠ¸
            updateDecisionAnalysis(decision, won);
        }

        // ëŒ€ëŸ‰ ì‹œë®¬ë ˆì´ì…˜
        function runSimulation() {
            log('ğŸš€ ëŒ€ëŸ‰ ì‹œë®¬ë ˆì´ì…˜ ì‹œì‘ (ê° ì „ëµ 1000íšŒì”©)');
            
            // ì „ëµ ëª©ë¡ì— 'human_intuition' ì¶”ê°€
            ['stay', 'switch', 'bayesian', 'human_intuition'].forEach(strategy => {
                for (let i = 0; i < 1000; i++) {
                    // ì—ì´ì „íŠ¸ ìƒì„± ë¡œì§ ìˆ˜ì •
                    let agent = strategy === 'human_intuition' ? 
                        new HumanIntuitionAgent() : 
                        new MontyHallAgent(strategy);
                    
                    let prizeDoor = Math.floor(Math.random() * 3);
                    let selectedDoor = Math.floor(Math.random() * 3);
                    
                    // ì‚¬íšŒìê°€ ì—´ ìˆ˜ ìˆëŠ” ë¬¸ ì°¾ê¸°
                    let availableDoors = [];
                    for (let j = 0; j < 3; j++) {
                        if (j !== selectedDoor && j !== prizeDoor) {
                            availableDoors.push(j);
                        }
                    }
                    let openedDoor = availableDoors[Math.floor(Math.random() * availableDoors.length)];
                    
                    // AI ê²°ì •
                    let decision = agent.makeDecision(selectedDoor, openedDoor);
                    let won = decision.finalChoice === prizeDoor;
                    
                    // í†µê³„ ì—…ë°ì´íŠ¸
                    let statKey = strategy === 'human_intuition' ? 'human_intuition' : strategy;
                    statistics[statKey].games++;
                    if (won) {
                        statistics[statKey].wins++;
                    }
                }
            });
            
            updateStatistics();
            log('âœ… ëŒ€ëŸ‰ ì‹œë®¬ë ˆì´ì…˜ ì™„ë£Œ (ì¸ê°„ ì§ê´€ í¬í•¨)');
        }

        // í™”ë©´ ì—…ë°ì´íŠ¸ í•¨ìˆ˜ë“¤
        function updateDoorDisplay() {
            document.querySelectorAll('.door').forEach((door, index) => {
                door.classList.remove('selected', 'opened', 'winner');
                
                if (index === gameState.selectedDoor) {
                    door.classList.add('selected');
                }
                if (index === gameState.openedDoor) {
                    door.classList.add('opened');
                    door.textContent = 'ğŸ';
                }
                if (gameState.gamePhase === 'finished' && index === gameState.prizeDoor) {
                    door.classList.add('winner');
                    door.textContent = 'ğŸ†';
                }
            });
        }

        function updateProbabilityDisplay() {
            for (let i = 0; i < 3; i++) {
                document.getElementById(`prob-${i}`).textContent = `${(gameState.probabilities[i] * 100).toFixed(1)}%`;
                document.getElementById(`bar-${i}`).style.width = `${gameState.probabilities[i] * 100}%`;
            }
        }

        function updateStatistics() {
            // í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
            document.getElementById('total-games').textContent = 
                statistics.stay.games + statistics.switch.games + 
                statistics.bayesian.games + statistics.human_intuition.games;
            document.getElementById('stay-wins').textContent = statistics.stay.wins;
            document.getElementById('switch-wins').textContent = statistics.switch.wins;
            document.getElementById('bayesian-wins').textContent = statistics.bayesian.wins;
            document.getElementById('human-wins').textContent = statistics.human_intuition.wins;
            
            // ìŠ¹ë¥  ê³„ì‚°
            let stayRate = statistics.stay.games > 0 ? (statistics.stay.wins / statistics.stay.games * 100).toFixed(1) : 0;
            let switchRate = statistics.switch.games > 0 ? (statistics.switch.wins / statistics.switch.games * 100).toFixed(1) : 0;
            let bayesianRate = statistics.bayesian.games > 0 ? (statistics.bayesian.wins / statistics.bayesian.games * 100).toFixed(1) : 0;
            let humanRate = statistics.human_intuition.games > 0 ? 
                (statistics.human_intuition.wins / statistics.human_intuition.games * 100).toFixed(1) : 0;
            
            document.getElementById('stay-rate').textContent = `${stayRate}%`;
            document.getElementById('switch-rate').textContent = `${switchRate}%`;
            document.getElementById('bayesian-rate').textContent = `${bayesianRate}%`;
            document.getElementById('human-rate').textContent = `${humanRate}%`;
            
            // ì°¨íŠ¸ ì—…ë°ì´íŠ¸
            let totalGames = statistics.stay.games + statistics.switch.games + statistics.bayesian.games;
            chart.data.labels.push(totalGames);
            chart.data.datasets[0].data.push(parseFloat(stayRate));
            chart.data.datasets[1].data.push(parseFloat(switchRate));
            chart.data.datasets[2].data.push(parseFloat(bayesianRate));
            chart.data.datasets[3].data.push(parseFloat(humanRate));
            
            // ì°¨íŠ¸ ë°ì´í„° ì œí•œ (ìµœê·¼ 50ê°œ í¬ì¸íŠ¸ë§Œ)
            if (chart.data.labels.length > 50) {
                chart.data.labels.shift();
                chart.data.datasets.forEach(dataset => dataset.data.shift());
            }
            
            chart.update();
        }

        function updateDecisionAnalysis(decision, won) {
            let analysis = document.getElementById('decision-analysis');
            analysis.innerHTML = `
                <h5>ğŸ§  AI ì˜ì‚¬ê²°ì • ë¶„ì„</h5>
                <p><strong>ì „ëµ:</strong> ${gameState.currentAgent.name}</p>
                <p><strong>ì¶”ë¡ :</strong> ${decision.reasoning}</p>
                <p><strong>í™•ë¥  ê³„ì‚°:</strong></p>
                <ul>
                    <li>ë¬¸ 1: ${(decision.probabilities[0] * 100).toFixed(1)}%</li>
                    <li>ë¬¸ 2: ${(decision.probabilities[1] * 100).toFixed(1)}%</li>
                    <li>ë¬¸ 3: ${(decision.probabilities[2] * 100).toFixed(1)}%</li>
                </ul>
                <p><strong>ê²°ê³¼:</strong> ${won ? 'âœ… ì„±ê³µ' : 'âŒ ì‹¤íŒ¨'}</p>
            `;
        }

        // ì „ì²´ ì´ˆê¸°í™” í•¨ìˆ˜
        function resetAll() {
            // ê²Œì„ ìƒíƒœ ì´ˆê¸°í™”
            resetGame();
            
            // í†µê³„ ì´ˆê¸°í™”
            statistics = {
                stay: { games: 0, wins: 0 },
                switch: { games: 0, wins: 0 },
                bayesian: { games: 0, wins: 0 },
                human_intuition: { games: 0, wins: 0 }
            };
            
            // ì°¨íŠ¸ ì´ˆê¸°í™”
            chart.data.labels = [];
            chart.data.datasets[0].data = [];
            chart.data.datasets[1].data = [];
            chart.data.datasets[2].data = [];
            chart.data.datasets[3].data = [];
            chart.update();
            
            // í™”ë©´ ì—…ë°ì´íŠ¸
            updateStatistics();
            document.getElementById('current-agent').textContent = 'ì „ëµ ì„ íƒ';
            
            // ì˜ì‚¬ê²°ì • ë¶„ì„ ì´ˆê¸°í™”
            document.getElementById('decision-analysis').innerHTML = `
                <p>AI ì—ì´ì „íŠ¸ì˜ í™•ë¥ ì  ì˜ì‚¬ê²°ì • ê³¼ì •ì„ ê´€ì°°í•´ë³´ì„¸ìš”.</p>
                <p>ë² ì´ì¦ˆ ì •ë¦¬ë¥¼ í™œìš©í•œ í™•ë¥  ì—…ë°ì´íŠ¸ì™€ ìµœì  ì „ëµ ì„ íƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
            `;
            
            // ë¡œê·¸ ì´ˆê¸°í™”
            document.getElementById('game-log').innerHTML = '';
            
            log('ğŸ”„ ì „ì²´ ì´ˆê¸°í™” ì™„ë£Œ');
            log('ğŸ¯ ëª¬í‹°í™€ ë”œë ˆë§ˆ AI ì‹œë®¬ë ˆì´í„°ê°€ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤.');
            log('ğŸ“š ì´ë¡ ì  í™•ë¥ : ìœ ì§€ ì „ëµ 33.3%, ë³€ê²½ ì „ëµ 66.7%');
        }

        function resetGame() {
            gameState = {
                prizeDoor: null,
                selectedDoor: null,
                openedDoor: null,
                currentAgent: null,
                gamePhase: 'setup',
                probabilities: [1/3, 1/3, 1/3]
            };
            
            document.querySelectorAll('.door').forEach(door => {
                door.classList.remove('selected', 'opened', 'winner');
                door.textContent = 'ğŸšª';
            });
            
            updateProbabilityDisplay();
        }

        function log(message) {
            let logElement = document.getElementById('game-log');
            logElement.innerHTML += `<div>${new Date().toLocaleTimeString()}: ${message}</div>`;
            logElement.scrollTop = logElement.scrollHeight;
        }

        // HTML ë²„íŠ¼ ì¶”ê°€
        document.querySelector('.controls').innerHTML += `
            <button onclick="startGame('human_intuition')" class="btn">
                ğŸ‘¤ ì¸ê°„ ì§ê´€ ì‹œë®¬ë ˆì´ì…˜
            </button>
        `;

        // ì´ˆê¸°í™”
        updateProbabilityDisplay();
        log('ğŸ¯ ëª¬í‹°í™€ ë”œë ˆë§ˆ AI ì‹œë®¬ë ˆì´í„°ê°€ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤.');
        log('ğŸ“š ì´ë¡ ì  í™•ë¥ : ìœ ì§€ ì „ëµ 33.3%, ë³€ê²½ ì „ëµ 66.7%');
    </script>
</body>
</html>